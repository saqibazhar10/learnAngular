<!-- Wrapper: Sidebar + Content -->
<div class="flex h-screen w-screen">

<app-navbar (conversationIdChange)="onConversationIdChange($event)"></app-navbar>

    <!-- Main Content Area -->
    <div class="flex-1 flex flex-col items-center justify-center">
        <div class="text-2xl text-black font-semibold" *ngIf="showDiv">
            Welcome To SecureGPT
        </div>
        <div class="w-full h-full overflow-y-auto border border-gray-300 rounded relative" *ngIf="showDivCov">

            <!-- Sticky Header -->
            <div class="sticky top-0 z-10 p-5 text-xl font-medium border-b border-gray-300 bg-white">
                {{chatHistory[0].conv_title}}
            </div>

            <!-- Chat Messages -->
            <div *ngFor="let chat of chatHistory" class="font-normal justify-center mx-20">
                <div class="mt-5 ml-10 mr-10">
                    {{ chat.userMessage }}
                </div>
                <div class="text-xs text-gray-500 text-left m-2 ml-10 mr-10">{{ chat.userTimestamp | date:'dd/MM/yyyy -
                    h:mm:ss a' }}</div>

                <div *ngIf="chat.loading" class="italic text-gray-500 ml-10 mr-10">
                    Thinking...
                </div>

                <div *ngIf="!chat.loading && chat.llm_response" class="mt-5 ml-10 mr-10">
                    <markdown [data]="chat.llm_response"></markdown>

                </div>
                <div class="text-xs text-gray-500 text-left m-2 ml-10 mr-10">{{ chat.llmTimestamp | date:'dd/MM/yyyy -
                    h:mm:ss a' }}</div>
                    <hr class="h-px bg-white border-0 ">
            </div>
        </div>


        <div class="flex items-center gap-3 mb-5 px-6 mt-7 rounded-full w-3/6 border border-[#F5F5F5] py-1 bg-white">
            <input type="text" (input)="getUserMessage($event)" [value]="userMessage"
                placeholder="What's in your mind?.." class="placeholder-gray-500 p-3 w-full text-xs font-normal
               focus:outline-none focus:ring-0 focus:border-transparent"  (keydown)="onKeyDown($event)">

            <div class="bg-[#5662f6] w-10 h-10 flex items-center justify-center rounded-full" (click)="submitMessage()" >

                <div class="w-10 h-10 flex items-center justify-center bg-[#5662f6] rounded-full overflow-hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none"
                        stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </div>

            </div>
        </div>

    </div>

</div>